(function(b){function a(c){if(c.result=="success"){b("form#reused_form").hide();b("#success_message").show();b("#error_message").hide()}else{b("#error_message").append("<ul></ul>");jQuery.each(c.errors,function(d,e){b("#error_message ul").append("<li>"+d+":"+e+"</li>")});b("#success_message").hide();b("#error_message").show();b('button[type="button"]',$form).each(function(){$btn=b(this);label=$btn.prop("orig_label");if(label){$btn.prop("type","submit");$btn.text(label);$btn.prop("orig_label","")}})}}b("#reused_form").submit(function(c){c.preventDefault();$form=b(this);b('button[type="submit"]',$form).each(function(){$btn=b(this);$btn.prop("type","button");$btn.prop("orig_label",$btn.text());$btn.text("Sending ...")});b.ajax({type:"POST",url:"handler.php",data:$form.serialize(),success:a,dataType:"json"})})})(jQuery);